/* =========================================
   1. GLOBAL VARIABLES & TYPOGRAPHY
   ========================================= */
:root {
    /* --- MAIN PALETTE --- */
    --base-10: oklch(99% 0.01 var(--hue));   /* Paper Color (Cream) */
    --base-9: oklch(95% 0.03 var(--hue));    /* Code Blocks */
    --base-8: oklch(92% 0.04 var(--hue));    /* Borders */
    --base-7: oklch(85% 0.08 var(--hue));
    --base-6: oklch(75% 0.10 var(--hue));
    --base-5: oklch(55% 0.20 var(--hue));    /* Accent */
    --base-4: oklch(45% 0.15 var(--hue));
    --base-3: oklch(35% 0.12 var(--hue));
    --base-2: oklch(25% 0.10 var(--hue));
    --base-1: oklch(15% 0.05 var(--hue));    /* Main Text */
    --base-0: oklch(10% 0.02 var(--hue));    /* Darkest Ink */

    /* --- WOOD TEXTURE COLORS (Converted to OKLCH) --- */
    --wood-base:   oklch(28% 0.038 68);       /* Deep Walnut Brown */
    --wood-light:  oklch(100% 0 0 / 2%);      /* Grain Highlight */
    --wood-dark:   oklch(0% 0 0 / 20%);       /* Grain Shadow */
    --wood-glow:   oklch(75% 0.15 50 / 60%);  /* Warm Varnish Glow */
    --wood-shadow: oklch(10% 0 0 / 60%);      /* Desk Vignette */
    
    /* --- PAPER STACK COLORS --- */
    --stack-color: oklch(95% 0 0);            /* The light grey edge of paper pages */
    --shadow-ink:  oklch(0% 0 0);             /* Pure black for mixing shadows */

    /* Font Stack */
    font-family: "Palatino Linotype", Palatino, Palladio, "URW Palladio L", "Book Antiqua", Baskerville, "Bookman Old Style", "Bitstream Charter", "Nimbus Roman No9 L", Garamond, "Apple Garamond", "ITC Garamond Narrow", "New York", "Times New Roman", Times, serif;
}

/* =========================================
   2. SHARED CONTENT STYLES (Screen & Print)
   ========================================= */
body {
    color: var(--base-1);
    line-height: 1.45;
    text-align: justify;
    hyphens: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* --- Paragraphs --- */
p {
    margin: 0;
    text-align: justify;
    text-justify: inter-character;
    text-align-last: left; 
    orphans: 3; 
    widows: 3;
}

/* Indent subsequent paragraphs */
p + p {
    text-indent: 1.5em;
    margin-top: 0;
}

hr {
    border: 0;
    height: 1px;
    /* Converted RGBA Gradient to OKLCH */
    background-image: linear-gradient(
        to right, 
        oklch(0% 0 0 / 0), 
        oklch(0% 0 0 / 0.75), 
        oklch(0% 0 0 / 0)
    );
    margin: 3em 0;
    break-after: always; 
    page-break-after: always;
}

/* Reset indent after non-text elements */
h1 + p, h2 + p, h3 + p, h4 + p, h5 + p, h6 + p, pre + p, figure + p, blockquote + p {
    text-indent: 0;
    margin-top: 0.8em;
    orphans: 3; 
    widows: 3;
 }

/* --- Headings --- */
h1, h2, h3, h4, h5, h6 {
    font-weight: 700;
    color: var(--base-0);
    margin-top: 2em;
    margin-bottom: 1em;
    line-height: 1.2;
    text-align: center;
    
    break-after: avoid;
    break-inside: avoid;
    page-break-after: avoid;
    page-break-inside: avoid;
}

h1 {
    font-size: 2.0em;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding-bottom: 0em;
}

h2 {
    font-size: 1.4em;
    font-variant: small-caps;
    position: relative;
    margin-bottom: 0.8em; 
}

h2::after {
    content: "❖";
    display: block;
    color: var(--base-3);
    font-size: 1.5rem;
    line-height: 1.5;
    margin-top: 0.5em;
}

/* --- Links --- */
a {
    color: var(--base-4); 
    text-decoration: none;
    border-bottom: 1px dotted var(--base-5);
    font-weight: 600;
    transition: all 0.2s ease;
}

a:hover {
    background-color: var(--base-9);
    color: var(--base-0);
    border-bottom: 1px solid var(--base-0);
}

/* --- Code Blocks --- */
code, pre {
    background: var(--base-9); 
    border: 1px solid var(--base-8);
    border-radius: 6px;
    font-family: "JetBrains Mono", "Fira Code", Monaco, monospace;
    font-size: 0.85em;
    color: var(--base-2);
}

code { padding: 0.1em 0.3em; }

pre {
    position: relative;
    padding: 1em;
    margin: 1.5em 0;
    white-space: pre-wrap;
    word-break: break-word;
    overflow-wrap: break-word;
    /* Converted shadow rgba(0,0,0,0.05) */
    box-shadow: inset 0 0 5px oklch(0% 0 0 / 5%);
    break-inside: avoid;
    page-break-inside: avoid;
}

pre[data-lang]::before {
  content: attr(data-lang);
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  font-size: 0.8em;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  background: var(--base-8);
  padding: 0.2em 0.5em;
  border-radius: 3px;
  color: var(--base-1);
  opacity: 0.9;
}

/* --- Tables --- */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 2em 0;
    font-size: 0.9em;
    break-inside: avoid;
    page-break-inside: avoid;
}

table :is(th, td) {
    border: none;
    padding: 0.5rem;
}

table > thead {
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-bottom: 1px solid var(--base-1);
}

table > tbody > tr:nth-child(even) {
    background: oklch(0% 0 0 / 3%);
}

/* --- Images & Figures --- */
img {
    max-width: 90% !important;
    display: block;
    margin: 1em auto;
    padding: 0.8em;
    background: oklch(100% 0 0);
    border: 1px solid var(--base-7);
    break-inside: avoid;
    page-break-inside: avoid;
}

blockquote {
    position: relative;
    margin: 3em 2em;
    padding-top: 1.5em;
    color: var(--base-0);
    font-style: italic;
    font-family: "Georgia", serif;
    text-align: center;
    break-inside: avoid;       
    page-break-inside: avoid;
}

blockquote::before {
    content: "“";
    position: absolute;
    top: -0.3em;
    left: 0;
    right: 0;
    margin: auto;
    display: block;
    font-size: 4em;
    color: var(--base-3);
    line-height: 1;
    height: 0.5em;
}

/* =========================================
   3. SCREEN ONLY (The Desk Look)
   ========================================= */
@media screen {
   html {
        /* Walnut Wood Texture */
        background-color: var(--wood-base);
        background-image:
            /* Layer 1: Subtle diagonal grain (light) */
            repeating-linear-gradient(
                120deg,
                var(--wood-light) 0px,
                var(--wood-light) 1px,
                transparent 1px,
                transparent 10px
            ),
            /* Layer 2: Subtle steep grain (dark) */
            repeating-linear-gradient(
                20deg,
                var(--wood-dark) 0px,
                var(--wood-dark) 1px,
                transparent 1px,
                transparent 5px
            ),
            /* Layer 3: Warm center glow/varnish effect */
            radial-gradient(ellipse at center, var(--wood-glow) 0%, var(--wood-shadow) 100%);

        background-attachment: fixed; 
        padding: 40px 0;
        min-height: 100%;
    }

    body {
        background-color: var(--base-10);
        width: clamp(500px, 70ch, 800px);
        min-height: 90vh;
        margin: 0 auto;
        padding: 4rem 5rem;
        
        /* 3D Stack Shadow (Top Stack) - Converted to OKLCH */
        box-shadow: 
            0 -1px 1px  oklch(0% 0 0 / 35%), 
            0 -10px 0 -6px var(--stack-color), 
            0 -10px 1px -4px oklch(0% 0 0 / 25%), 
            0 -20px 0 -12px var(--stack-color), 
            0 -20px 1px -10px oklch(0% 0 0 / 15%),
            0 15px 30px oklch(0% 0 0 / 20%);
        
        border-radius: 2px;
    }

    img {
        /* Converted rgba(0,0,0,0.1) */
        box-shadow: 0 2px 5px oklch(0% 0 0 / 10%);
        transform: rotate(-1deg);
    }
}

/* =========================================
   4. PRINT ONLY (The Real Book)
   ========================================= */
@page {
    @top-center {
        content: string(chapter-title);
        font-size: 9pt;
        font-family: sans-serif;
        color: var(--base-3);
        letter-spacing: 1px;
        text-transform: uppercase;
    }
    @bottom-center {
        content: counter(page);
        font-size: 10pt;
        color: var(--base-2);
        font-weight: bold;
    }
}

@media print {
    html {
        background: none;
        padding: 0;
    }

    body {
        background: transparent;
        width: 100%;
        max-width: none;
        margin: 0;
        padding: 0;
        box-shadow: none;
        color: oklch(0% 0 0); /* Pure Black */
    }

    img {
        transform: none;
        box-shadow: none;
        max-width: 100% !important;
    }

    a {
        color: oklch(0% 0 0);
        border-bottom: 1px solid oklch(60% 0 0); /* Grey border */
    }

    button, .nav, .no-print, .sb-hashtag {
        display: none !important;
    }
}